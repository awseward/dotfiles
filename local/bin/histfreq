#!/usr/bin/env bash

set -euo pipefail

lines() {
  cat "${HISTFILE:-$HOME/.zsh_history}" \
  | sed -E 's/^: [0-9]+:[0-9]+;//' \
  | LC_ALL='C' sort \
  | uniq -c \
  | LC_ALL='C' sort -nr \
  | sed -E 's/^\ +//'
}

json() {
  lines | jq --raw-input "$@" '
    split(" ")
    | { count: first|tonumber, value: .[1:]|join(" ") }
  '
}

# ---

"$@"
