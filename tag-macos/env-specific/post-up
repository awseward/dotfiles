#!/usr/bin/env bash

set -euo pipefail

_clone_iterm_color_schemes() {
  local schemes_repo='git@github.com:mbadolato/iTerm2-Color-Schemes.git'
  local schemes_dir="$HOME/.iterm2-color-schemes"

  if [ ! -d "$schemes_dir" ]; then
    git clone --depth=1 "$schemes_repo" "$schemes_dir"
  fi
}

_display_messages() {
  if [ -z ${TERM+x} ] || [ "$TERM" = 'dumb' ]; then
    export TERM='xterm-256color'
  fi

  mdp --nofade <<MSG

# Dotfiles setup complete (mostly...)!

Following slides contain futher information.

---

## iTerm2 Configuration

Please make sure iTerm2 is configured to load from \`~/.iterm\`.

This can be configured by navigating to \`Preferences > General\` and then
looking for the phrase (near the bottom):

\`Load preferences from a custom folder or URL\`

Also, when importing color schemes from \`~/.iterm2-color-schemes\`, in case
finder is not configured to show hidden files/folders, you can quickly toggle
this with \`CMD + SHIFT + .\`.

Don't forget to not only import it, but then also configure it to be used as
well.

---

## Shell Restart

If this is the very first time running this on a given machine, you may want to
restart the shell or just hop into a new tab from this point.

I'd like to automate that, but in what I've tried so far, nothing has been
able to do the final transition from macOS' very old bash to zsh automatically,
so it's still a bit manual for now.

MSG
}

# ---

_clone_iterm_color_schemes
_display_messages
